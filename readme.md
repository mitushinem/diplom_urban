# Telergram Bot for Hotels.com



Бот реализован на Python 3.13 и использует для работы API rapidapi.com. Для правильной и корректной работы бота необходимо дополнительно установить библиотеки из requirements.txt 

**Бот производит поиск отелей по каталогу сайта Hotels.com по заданным критериям.**  



## Установка и запуск

> Для корректной работы бота, на сервере должен быть установлен python 3.10 и выше

1.  Установка всех необходимых зависимостей для работы бота

   ```
   pip install -r /path/to/requirements.txt
   ```

2. Зарегистрировать нового бота и получить секретный ключ

3. Зарегистрироваться на https://rapidapi.com/ и получить ключ API 

4. Создать файл **.env** и заполнить его по аналогии с **.env.template**

5. Запуск миграции  

   ```
     alembic init migration
   ```
6. В файл env.ry добавить код. Это требуется для корректной миграции в асинхронном режиме работы
     ```
    from config.config import settings
    from database.models import History, User #noqa
    from database.models import Base
   
   if config.config_file_name is not None:
        fileConfig(config.config_file_name)

   config.set_main_option('sqlalchemy.url', settings.DATABASE_URL_asyncpg + '?async_fallback=true')
   target_metadata = Base.metadata
    ```
7. запуск команд для создания таблиц в БД. Сама база должна быть создана
   ```
         alembic revision --autogenerate -m "init"
         alembic upgrade head
   ```  

7. Запустить бота командой **python main.py**



## Описание модулей

Для работы бота используется БД PostgreSQL. 

Бот состоит из следующих модулей:

1. **config** – содержит настройки конфигурации
2. **database** - содержит описание моделей и методы работы с БД. hotels-tb.db может отсутствовать, создается при первом старте бота
3. **filters** - custom фильтры для определения ввода данных от пользователя
4. **handlers** - в данном модуле описана работа всех команд бота, а также callback обработчики
5. **keyboards** - методы клавиатур, используемых для работы бота
6. **rapid_api** - модуль для работы c API
7. **state** - модуль, в котором описаны все состояния работы бота
8. **utils** - дополнительные методы, которые не вошли в другие моддули
9. **main.py** - Основной файл проекта. Запускает работу бота.
10. **loader.py** - инициализация бота
11. **.env** - хранятся секретные ключи от телеграмм и API



## Команды

- **start** - Запустить бота
- **help** - Вывести справку с описанием работы
- **lowprice** - вывод самых дешевых отелей
- **highprice** - вывод самых дорогих отелей
- **bestdeal** - выбрать отели по своим параметрам: расстояние от центра и ценовые диапазоны
- **history** - история запросов по работе с ботом
